<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>HTTPS &amp; TLS </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="HTTPS &amp; TLS ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="https--tls">HTTPS &amp; TLS</h1>

<p>HTTPS (HTTP over TLS encrypted connections) is the standard way to make HTTP requests on the Internet for security, integrity, and privacy reasons. There are several HTTPS/TLS considerations to account for when using a reverse proxy like YARP.</p>
<h2 id="tls-termination">TLS Termination</h2>
<p>YARP is a level 7 HTTP proxy which means that incoming HTTPS/TLS connections are fully decrypted by the proxy so it can process and forward the HTTP requests. This is commonly known as TLS Termination. The outgoing connections to the destination(s) may or may not be encrypted, depending on the configuration provided.</p>
<h2 id="tls-tunneling-connect">TLS tunneling (CONNECT)</h2>
<p>TLS tunneling using the CONNECT method is a feature used to proxy requests without decrypting them. This is <em>not</em> supported by YARP and there are no plans to add it.</p>
<h2 id="configuring-incoming-connections">Configuring incoming connections</h2>
<p>YARP can run on top of all ASP.NET Core servers and configuring HTTPS/TLS for incoming connections is server specific. Check the docs for <a href="https://docs.microsoft.com/aspnet/core/fundamentals/servers/kestrel/endpoints#listenoptionsusehttps">Kestrel</a>, <a href="https://docs.microsoft.com/iis/manage/configuring-security/how-to-set-up-ssl-on-iis">IIS</a>, and <a href="https://docs.microsoft.com/aspnet/core/fundamentals/servers/httpsys#configure-windows-server-1">Http.Sys</a> for configuration details.</p>
<h3 id="advanced-tls-filters-with-kestrel">Advanced TLS filters with Kestrel</h3>
<p>Kestrel supports intercepting incoming connections before the TLS handshake. YARP includes a <a class="xref" href="../api/Yarp.ReverseProxy.Utilities.Tls.TlsFrameHelper.html">TlsFrameHelper</a> API that can parse the raw TLS handshake and enable you to gather custom telemetry or eagerly reject connections. These APIs cannot modify the TLS handshake or decrypt the data stream. See this <a href="https://github.com/microsoft/reverse-proxy/blob/v1.0.0-rc.1/testassets/ReverseProxy.Direct/TlsFilter.cs">example</a>.</p>
<h2 id="configuring-outgoing-connections">Configuring outgoing connections</h2>
<p>To enable TLS encryption when communicating with a destination specify the destination address as <code>https</code> like <code>&quot;https://destinationHost&quot;</code>. See the <a href="config-files.html#configuration-structure">configuration docs</a> for examples.</p>
<p>The host name specified in the destination address will be used for the TLS handshake by default, including SNI and server certificate validation. If proxying the <a href="transforms.html#requestheaderoriginalhost">original host header</a> is enabled, that value will be used for the TLS handshake instead. If a custom host value needs to be used then use the <a href="transforms.html#requestheader">RequestHeader</a> transform to set the host header.</p>
<p>Outbound connections to the destinations are handled by HttpClient/SocketsHttpHandler. A different instance and settings can be configured per cluster. Some settings are available in the configuration model, while others can only be configured in code. See the <a href="http-client-config.html">HttpClient</a> docs for details.</p>
<p>Destination server certificates need to be trusted by the proxy or custom validation needs to be applied via the <a href="http-client-config.html">HttpClient</a> configuration.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/microsoft/reverse-proxy/blob/release/latest/docs/docfx/articles/https-tls.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
